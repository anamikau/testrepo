Fixing Bug 1.
Modifying my awesome code.
fixing bug 2
fixing bug 3
